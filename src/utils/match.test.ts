import { weightedLevenshteinDistance } from "./match";

interface Order {
  브랜드: string;
  상품명: string;
  색상: string;
  사이즈: string;
  수량: number;
  상가명: string;
  도매가: number;
  Nor상품명: string;
  Nor색상: string;
  Nor사이즈: string;
}

interface Receipt {
  브랜드: string;
  상품명: string;
  색상: string;
  사이즈: string;
  수량: number;
  미송여부: boolean;
}

const orderData: Order[] = [
  {
    브랜드: "nrk",
    상품명: "ST시보리티",
    색상: "베이지",
    사이즈: "M",
    수량: 1,
    상가명: "크레용",
    도매가: 9000,
    Nor상품명: "S티셔츠시보리티셔츠",
    Nor색상: "베이지",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "골덴팔부바지",
    색상: "베이지",
    사이즈: "S",
    수량: 1,
    상가명: "크레용",
    도매가: 15000,
    Nor상품명: "골덴팔부팬츠",
    Nor색상: "베이지",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "골덴팔부바지",
    색상: "차콜",
    사이즈: "XL",
    수량: 1,
    상가명: "크레용",
    도매가: 15000,
    Nor상품명: "골덴팔부팬츠",
    Nor색상: "챠콜",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "그라운드남방",
    색상: "아이",
    사이즈: "XL",
    수량: 1,
    상가명: "크레용",
    도매가: 18000,
    Nor상품명: "그라운드남방",
    Nor색상: "아이보리",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "덴깡카라맨투맨",
    색상: "검정",
    사이즈: "4XL",
    수량: 1,
    상가명: "크레용",
    도매가: 21000,
    Nor상품명: "덴깡카라맨투맨",
    Nor색상: "블랙",
    Nor사이즈: "4XL",
  },
  {
    브랜드: "nrk",
    상품명: "덴깡카라맨투맨",
    색상: "핑크",
    사이즈: "M",
    수량: 1,
    상가명: "크레용",
    도매가: 18000,
    Nor상품명: "덴깡카라맨투맨",
    Nor색상: "핑크",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "덴깡카라맨투맨",
    색상: "핑크",
    사이즈: "S",
    수량: 1,
    상가명: "크레용",
    도매가: 18000,
    Nor상품명: "덴깡카라맨투맨",
    Nor색상: "핑크",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "면카라니트",
    색상: "블랙",
    사이즈: "L",
    수량: 1,
    상가명: "크레용",
    도매가: 22000,
    Nor상품명: "면카라니트",
    Nor색상: "블랙",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "면카라니트",
    색상: "블랙",
    사이즈: "L",
    수량: 1,
    상가명: "크레용",
    도매가: 22000,
    Nor상품명: "면카라니트",
    Nor색상: "블랙",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "버디단가라세트",
    색상: "레드",
    사이즈: "L",
    수량: 1,
    상가명: "크레용",
    도매가: 23000,
    Nor상품명: "버디단가라세트",
    Nor색상: "레드",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "버디단가라세트",
    색상: "파랑",
    사이즈: "L",
    수량: 1,
    상가명: "크레용",
    도매가: 23000,
    Nor상품명: "버디단가라세트",
    Nor색상: "블루",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "보데티",
    색상: "네이비",
    사이즈: "S",
    수량: 1,
    상가명: "크레용",
    도매가: 10000,
    Nor상품명: "보데티셔츠",
    Nor색상: "네이비",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "보데티",
    색상: "아이",
    사이즈: "S",
    수량: 1,
    상가명: "크레용",
    도매가: 10000,
    Nor상품명: "보데티셔츠",
    Nor색상: "아이보리",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "스쿨룩조끼",
    색상: "아이",
    사이즈: "XS",
    수량: 1,
    상가명: "크레용",
    도매가: 18000,
    Nor상품명: "스쿨룩조끼",
    Nor색상: "아이보리",
    Nor사이즈: "XS",
  },
  {
    브랜드: "nrk",
    상품명: "스쿨룩조끼",
    색상: "아이(크림)",
    사이즈: "4XL",
    수량: 1,
    상가명: "크레용",
    도매가: 21000,
    Nor상품명: "스쿨룩조끼",
    Nor색상: "아이크림",
    Nor사이즈: "4XL",
  },
  {
    브랜드: "nrk",
    상품명: "어텀테이프세트",
    색상: "메란지",
    사이즈: "M",
    수량: 1,
    상가명: "크레용",
    도매가: 25000,
    Nor상품명: "어텀테이프세트",
    Nor색상: "메란지지",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "어텀테이프세트",
    색상: "메란지",
    사이즈: "XL",
    수량: 1,
    상가명: "크레용",
    도매가: 25000,
    Nor상품명: "어텀테이프세트",
    Nor색상: "메란지지",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "와플테입티",
    색상: "곤색",
    사이즈: "S",
    수량: 1,
    상가명: "크레용",
    도매가: 16000,
    Nor상품명: "와플테입티셔츠",
    Nor색상: "곤색",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "주름팔부바지",
    색상: "메란지",
    사이즈: "M",
    수량: 1,
    상가명: "크레용",
    도매가: 17000,
    Nor상품명: "주름팔부팬츠",
    Nor색상: "메란지지",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "주름팔부바지",
    색상: "메란지",
    사이즈: "S",
    수량: 1,
    상가명: "크레용",
    도매가: 17000,
    Nor상품명: "주름팔부팬츠",
    Nor색상: "메란지지",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "트렌디시보리티",
    색상: "와인",
    사이즈: "M",
    수량: 1,
    상가명: "크레용",
    도매가: 12000,
    Nor상품명: "트렌디시보리티셔츠",
    Nor색상: "와인",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "파리카라세트",
    색상: "백메란지",
    사이즈: "4XL",
    수량: 1,
    상가명: "크레용",
    도매가: 26000,
    Nor상품명: "파리카라세트",
    Nor색상: "백메란지지",
    Nor사이즈: "4XL",
  },
  {
    브랜드: "nrk",
    상품명: "팔팔상하세트",
    색상: "네이비",
    사이즈: "XL",
    수량: 1,
    상가명: "크레용",
    도매가: 22000,
    Nor상품명: "팔팔상하세트",
    Nor색상: "네이비",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "팔팔상하세트",
    색상: "크림",
    사이즈: "2XL",
    수량: 1,
    상가명: "크레용",
    도매가: 25000,
    Nor상품명: "팔팔상하세트",
    Nor색상: "크림",
    Nor사이즈: "2XL",
  },
  {
    브랜드: "nrk",
    상품명: "팔팔상하세트",
    색상: "크림",
    사이즈: "L",
    수량: 1,
    상가명: "크레용",
    도매가: 22000,
    Nor상품명: "팔팔상하세트",
    Nor색상: "크림",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "팔팔상하세트",
    색상: "크림",
    사이즈: "S",
    수량: 1,
    상가명: "크레용",
    도매가: 22000,
    Nor상품명: "팔팔상하세트",
    Nor색상: "크림",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "피셔맨니트",
    색상: "네이비",
    사이즈: "L",
    수량: 1,
    상가명: "크레용",
    도매가: 25000,
    Nor상품명: "피셔맨니트",
    Nor색상: "네이비",
    Nor사이즈: "L",
  },
];

const receiptData = [
  {
    브랜드: "nrk",
    상품명: "23.ST시보리티",
    색상: "베이지",
    사이즈: "M",
    수량: 1,
    미송여부: false,
    Nor상품명: "S티셔츠시보리티셔츠",
    Nor색상: "베이지",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "33.골덴팔부바지",
    색상: "베이지",
    사이즈: "S",
    수량: 1,
    미송여부: true,
    Nor상품명: "골덴팔부팬츠",
    Nor색상: "베이지",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "33.골덴팔부바지",
    색상: "차콜",
    사이즈: "XL",
    수량: 1,
    미송여부: false,
    Nor상품명: "골덴팔부팬츠",
    Nor색상: "챠콜",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "5.그라운드남방",
    색상: "아이보리",
    사이즈: "XL",
    수량: 1,
    미송여부: false,
    Nor상품명: "그라운드남방",
    Nor색상: "아이보리",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "20.덴깡카라맨투맨",
    색상: "검정",
    사이즈: "4XL",
    수량: 1,
    미송여부: false,
    Nor상품명: "덴깡카라맨투맨",
    Nor색상: "블랙",
    Nor사이즈: "4XL",
  },
  {
    브랜드: "nrk",
    상품명: "20.덴장카라맨투맨",
    색상: "핑크",
    사이즈: "S",
    수량: 1,
    미송여부: true,
    Nor상품명: "덴장카라맨투맨",
    Nor색상: "핑크",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "20.덴깡카라맨투맨",
    색상: "핑크",
    사이즈: "M",
    수량: 1,
    미송여부: true,
    Nor상품명: "덴깡카라맨투맨",
    Nor색상: "핑크",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "8.면카라니트",
    색상: "검정",
    사이즈: "L",
    수량: 2,
    미송여부: false,
    Nor상품명: "면카라니트",
    Nor색상: "블랙",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "15.버디단가라세트",
    색상: "레드",
    사이즈: "L",
    수량: 1,
    미송여부: false,
    Nor상품명: "버디단가라세트",
    Nor색상: "레드",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "15.버디단가라세트",
    색상: "파랑",
    사이즈: "L",
    수량: 1,
    미송여부: true,
    Nor상품명: "버디단가라세트",
    Nor색상: "블루",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "25.보데티",
    색상: "네이비",
    사이즈: "S",
    수량: 1,
    미송여부: false,
    Nor상품명: "보데티셔츠",
    Nor색상: "네이비",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "25.보데티",
    색상: "아이",
    사이즈: "S",
    수량: 1,
    미송여부: false,
    Nor상품명: "보데티셔츠",
    Nor색상: "아이보리",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "9.스쿨룩조끼",
    색상: "아이",
    사이즈: "XS",
    수량: 1,
    미송여부: false,
    Nor상품명: "스쿨룩조끼",
    Nor색상: "아이보리",
    Nor사이즈: "XS",
  },
  {
    브랜드: "nrk",
    상품명: "9.스쿨룩조끼",
    색상: "아이",
    사이즈: "4XL",
    수량: 1,
    미송여부: false,
    Nor상품명: "스쿨룩조끼",
    Nor색상: "아이보리",
    Nor사이즈: "4XL",
  },
  {
    브랜드: "nrk",
    상품명: "14.어텀테이프세트",
    색상: "메란지",
    사이즈: "M",
    수량: 1,
    미송여부: true,
    Nor상품명: "어텀테이프세트",
    Nor색상: "메란지지",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "14.어텀테이프세트",
    색상: "메란지",
    사이즈: "XL",
    수량: 1,
    미송여부: true,
    Nor상품명: "어텀테이프세트",
    Nor색상: "메란지지",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "21.와플테입티",
    색상: "곤색",
    사이즈: "S",
    수량: 1,
    미송여부: false,
    Nor상품명: "와플테입티셔츠",
    Nor색상: "곤색",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "32.주름팔부바지",
    색상: "메란지",
    사이즈: "S",
    수량: 1,
    미송여부: false,
    Nor상품명: "주름팔부팬츠",
    Nor색상: "메란지지",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "32.주름팔부바지",
    색상: "메란지",
    사이즈: "M",
    수량: 1,
    미송여부: false,
    Nor상품명: "주름팔부팬츠",
    Nor색상: "메란지지",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "26.트렌디시보리티",
    색상: "와인",
    사이즈: "M",
    수량: 1,
    미송여부: false,
    Nor상품명: "트렌디시보리티셔츠",
    Nor색상: "와인",
    Nor사이즈: "M",
  },
  {
    브랜드: "nrk",
    상품명: "16.파리카라세트",
    색상: "백메란지",
    사이즈: "4XL",
    수량: 1,
    미송여부: false,
    Nor상품명: "파리카라세트",
    Nor색상: "백메란지지",
    Nor사이즈: "4XL",
  },
  {
    브랜드: "nrk",
    상품명: "12.팔팔상하세트",
    색상: "네이비",
    사이즈: "XL",
    수량: 1,
    미송여부: true,
    Nor상품명: "팔팔상하세트",
    Nor색상: "네이비",
    Nor사이즈: "XL",
  },
  {
    브랜드: "nrk",
    상품명: "12.팔팔상하세트",
    색상: "크림",
    사이즈: "2XL",
    수량: 1,
    미송여부: false,
    Nor상품명: "팔팔상하세트",
    Nor색상: "크림",
    Nor사이즈: "2XL",
  },
  {
    브랜드: "nrk",
    상품명: "12.팔팔상하세트",
    색상: "크림",
    사이즈: "L",
    수량: 1,
    미송여부: false,
    Nor상품명: "팔팔상하세트",
    Nor색상: "크림",
    Nor사이즈: "L",
  },
  {
    브랜드: "nrk",
    상품명: "12.팔팔상하세트",
    색상: "크림",
    사이즈: "S",
    수량: 1,
    미송여부: true,
    Nor상품명: "팔팔상하세트",
    Nor색상: "크림",
    Nor사이즈: "S",
  },
  {
    브랜드: "nrk",
    상품명: "7.피셔맨니트",
    색상: "네이비",
    사이즈: "L",
    수량: 1,
    미송여부: false,
    Nor상품명: "피셔맨니트",
    Nor색상: "네이비",
    Nor사이즈: "L",
  },
];

describe("weightedLevenshteinDistance", () => {
  test("두 문자열이 동일할 때 거리 0 반환", () => {
    expect(weightedLevenshteinDistance("test", "test")).toBe(0);
  });

  test("한 문자열이 빈 문자열일 때 거리 반환", () => {
    expect(weightedLevenshteinDistance("", "abc", {
      deleteCost: 1,
      insertCost: 1,
      substituteCost: 1,
    })).toBe(3);
    expect(weightedLevenshteinDistance("abc", "", {
      deleteCost: 1,
      insertCost: 1,
      substituteCost: 1,
    })).toBe(3);
  });

  test("기본 가중치로 거리 계산", () => {
    expect(weightedLevenshteinDistance("kitten", "sitting")).toBe(3);
  });

  test("가중치를 변경하여 거리 계산", () => {
    expect(weightedLevenshteinDistance("kitten", "sitting", {
      deleteCost: 2,
      insertCost: 2,
      substituteCost: 2,
    })).toBe(6);
  });

  test("삽입, 삭제, 대체가 필요한 경우", () => {
    expect(weightedLevenshteinDistance("flaw", "lawn")).toBe(2);
  });

  test("가중치가 다른 경우", () => {
    expect(weightedLevenshteinDistance("flaw", "lawn", {
      deleteCost: 1,
      insertCost: 2,
      substituteCost: 1,
    })).toBe(3);
  });
});

describe("weightedLevenshteinDistance with test data", () => {
  test("주문 내역과 영수증 데이터의 Nor상품명 비교 하여 최소거리 상품명 찾기", () => {
    const minDistanceMatch = new Map<
      string, // 주문 내역의 상품명
      {
        order: Order | null;
        receipt: Receipt | null;
        distance: number;
      }
    >();
    orderData.forEach((order) => {
      minDistanceMatch.set(order.상품명, {
        order,
        receipt: null,
        distance: Infinity,
      });
      receiptData.forEach((receipt) => {
        const distance = weightedLevenshteinDistance(
          order.상품명,
          receipt.상품명
        );
        if (distance < minDistanceMatch.get(order.상품명)!.distance) {
          minDistanceMatch.set(order.상품명, {
            order,
            receipt,
            distance,
          });
        }
      });
    });

    console.log(minDistanceMatch);
  });
});
